{"version":1,"kind":"Article","sha256":"b36d5086ac4f9e9628edb63de4a9519a236dcee221d85c7aa8284e3b6063fa13","slug":"reproducible-research.make.make-examples","location":"/reproducible-research/make/make-examples.md","dependencies":[],"frontmatter":{"title":"Learn “Make” by Examples","content_includes_title":false,"authors":[{"nameParsed":{"literal":"The Turing Way Community","given":"The Turing Way","family":"Community"},"name":"The Turing Way Community","id":"contributors-myst-generated-uid-0"}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/the-turing-way/the-turing-way","copyright":"2019-2025","numbering":{"title":{"offset":2}},"edit_url":"https://github.com/the-turing-way/the-turing-way/blob/main/book/website/reproducible-research/make/make-examples.md","thumbnail":"/build/makefile-no1-b529243d7ed81a06ff2fc30b6b03054d.png","exports":[{"format":"md","filename":"make-examples.md","url":"/build/make-examples-463a6705ef11e4d64f236a16967dce63.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Makefiles","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"REV66d77aF"}],"label":"rr-make-examples-makefiles","identifier":"rr-make-examples-makefiles","html_id":"rr-make-examples-makefiles","key":"M0Z0MgNpzh"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"One of the things that might discourage someone from using Make is that\nexisting Makefiles can look quite complex, and it might seem difficult to\ntailor one to your own needs. In this hands-on tutorial we will create a\nMakefile from scratch for a real data analysis project. The idea is to explain\ndifferent features of Make by iterating through several versions of a Makefile\nfor this project. Hopefully the experience that you gain from this tutorial\nallows you to create Makefiles for your own projects.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MR3k4DCakO"}],"key":"jrSwVQNZq1"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"We will create a ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"OPd7RGkGNR"},{"type":"inlineCode","value":"Makefile","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"tXsxZucKaf"},{"type":"text","value":" for a data analysis pipeline. The task is as\nfollows:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kDnObN3OCH"}],"key":"ZdD18gL1FJ"},{"type":"blockquote","position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Task: Given some datasets, create a summary report (in pdf) that contains\nthe histograms of these datasets.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"h5lp9W4Mli"}],"key":"omDKK6QL6w"}],"key":"VWyWNaB9iq"}],"key":"y2BPVIMlOW"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"(Of course this data task is very simple to focus on how to use Make.)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"st5h0J8fap"}],"key":"uAMuNKsgpw"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Throughout the tutorial code blocks that start with a dollar sign (","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"LZHBTfnxl3"},{"type":"inlineCode","value":"$","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Keib2Nutir"},{"type":"text","value":") are\nintended to be typed in the terminal.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"xYHNeLyghB"}],"key":"JXnQaLpZni"}],"key":"XszE8mXlaY"},{"type":"heading","depth":3,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Setting up","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"OmMqtTqa2K"}],"label":"rr-make-examples-settingup","identifier":"rr-make-examples-settingup","html_id":"rr-make-examples-settingup","key":"QA3pYTAXsr"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"We have created a basic repository for this task, that already contains\neverything that we need (","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"VGvuKEqDJt"},{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"except the Makefile of course!","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ekYPU0j1WS"}],"key":"tMBZZ1qFNa"},{"type":"text","value":"). To start, clone\nthe base repository using git:","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"qkWtQlepcZ"}],"key":"wr6akfTH8Q"},{"type":"code","lang":"bash","value":"$ git clone https://github.com/alan-turing-institute/IntroToMake","position":{"start":{"line":33,"column":1},"end":{"line":35,"column":1}},"key":"ict4jTU2pF"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"This basic repository contains all the code that we’ll need in this tutorial,\nand should have this content:","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"KTAy5iTB0f"}],"key":"Bii0YJIn9r"},{"type":"code","lang":"text","value":".\n├── data/\n│   ├── input_file_1.csv\n│   └── input_file_2.csv\n├── LICENSE\n├── output/\n├── README.md\n├── report/\n│   └── report.tex\n└── scripts/\n    └── generate_histogram.py","position":{"start":{"line":40,"column":1},"end":{"line":52,"column":1}},"key":"C01ZmGyAQg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":54,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"strong","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"data","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"k12v2Gma0T"}],"key":"DEmvUsqvrN"},{"type":"text","value":": directory with two datasets that we’re going to analyse","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"kmwQ3kzNLG"}],"key":"UW1kghHtBZ"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"report","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"SMycXjLKfV"}],"key":"DDDGZFDf6g"},{"type":"text","value":": the input directory for the report","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"reCM7JXF04"}],"key":"kbnVNcJP7f"},{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"strong","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"scripts","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"QZRTYYf7xr"}],"key":"H5kZqkdU8H"},{"type":"text","value":": directory for the analysis script","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"SUjPK7LaWn"}],"key":"qipt5VwLIW"},{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"strong","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"output","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"yQBjP69Gwu"}],"key":"FOSpaX6wxu"},{"type":"text","value":": output directory for the figures and the report","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"j2bYG357uG"}],"key":"rJ4cYlopLl"}],"key":"zaknl72u0S"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"You’ll notice that there are two datasets in the ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"lwNf7895JP"},{"type":"strong","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"data","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"d5qLbLOSqa"}],"key":"OFGNYCZ6E1"},{"type":"text","value":" directory\n(","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"OQagLFKgSD"},{"type":"inlineCode","value":"input_file_1.csv","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"mMCgu9vbQJ"},{"type":"text","value":" and ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Mpt5C1nlpK"},{"type":"inlineCode","value":"input_file_2.csv","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"lcpVTIlkbC"},{"type":"text","value":") and that there is already a\nbasic Python script in ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"toMs4OjqPv"},{"type":"strong","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"scripts","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"VbLrZw4ZEM"}],"key":"CUkaBtDy9i"},{"type":"text","value":" and a basic report LaTeX file in\n","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"gs78BA6902"},{"type":"strong","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"report","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"wWjrGL4zI1"}],"key":"Fm4RC0ewMW"},{"type":"text","value":".","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"dl1AESwIbO"}],"key":"mt8o8lEXdT"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"If you want to follow along, ensure that you have the ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"G55jAxqIB2"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"u0aR01Zhs3"},{"type":"text","value":" and\n","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"BZIpDv8qvz"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"Zp9afBJQdT"},{"type":"text","value":" packages installed:","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"RQS05fBRrC"}],"key":"ddwMsacfby"},{"type":"code","lang":"bash","value":"$ pip install matplotlib numpy","position":{"start":{"line":67,"column":1},"end":{"line":69,"column":1}},"key":"X0qQhCpKid"},{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"You will also need a working version of ","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"hqlWGY4j3W"},{"type":"inlineCode","value":"pdflatex","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"nu8abFDRPF"},{"type":"text","value":" and, of course, ","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"PT1qWJXG39"},{"type":"inlineCode","value":"make","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"bOJCery5L7"},{"type":"text","value":".","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"oipqyAQbpz"}],"key":"flg5BoxbFI"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"For installation instructions for Make, see ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"Yq9RSfup11"},{"type":"crossReference","kind":"heading","identifier":"rr-make-appendix-installing","label":"rr-make-appendix-installing","children":[{"type":"text","value":"Installing Make","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"vD8AHry91m"}],"template":"{name}","resolved":true,"html_id":"rr-make-appendix-installing","remote":true,"url":"/reproducible-research/make/make-appendix","dataUrl":"/reproducible-research.make.make-appendix.json","key":"KiPB992DQc"},{"type":"text","value":".","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"nqixL3blVV"}],"key":"nHKtwVVz2K"},{"type":"heading","depth":3,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Makefile no. 1 (The Basics)","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"jWzVunLvpJ"}],"label":"rr-make-examples-makefile1","identifier":"rr-make-examples-makefile1","html_id":"rr-make-examples-makefile1","key":"SJX4i8FTEd"},{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"Let’s create our first Makefile. In the terminal, move into the\n","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"zc7gocGqPz"},{"type":"inlineCode","value":"IntroToMake","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"akl555fYOw"},{"type":"text","value":" repository that you just cloned:","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"XqvrY3jtEy"}],"key":"L51HAckdzx"},{"type":"code","lang":"bash","value":"$ cd IntroToMake","position":{"start":{"line":81,"column":1},"end":{"line":83,"column":1}},"key":"EuLxtfI09C"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"Using your favourite editor, create a file called ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"uAkQp50Sn2"},{"type":"inlineCode","value":"Makefile","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"KOzc7dVoku"},{"type":"text","value":" with the\nfollowing contents:","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"MXwkDG55Un"}],"key":"XMoMQQ8vBm"},{"type":"code","lang":"makefile","value":"# Makefile for analysis report\n\noutput/figure_1.png: data/input_file_1.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i data/input_file_1.csv -o output/figure_1.png\n\noutput/figure_2.png: data/input_file_2.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i data/input_file_2.csv -o output/figure_2.png\n\noutput/report.pdf: report/report.tex output/figure_1.png output/figure_2.png\n\tcd report/ && pdflatex report.tex && mv report.pdf ../output/report.pdf","position":{"start":{"line":88,"column":1},"end":{"line":99,"column":1}},"key":"WMjlrZ2Bti"},{"type":"paragraph","position":{"start":{"line":100,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"The indentation in each of the recipes are ","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"WxZvKdC9Py"},{"type":"emphasis","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"strong","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"tabs","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"HXEDdhxJVC"}],"key":"zKhCqBbcKR"}],"key":"TRaEFbyK1g"},{"type":"text","value":", Makefiles do not accept\nindentation with spaces.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"ovlS7qmQKL"}],"key":"J23077e3eU"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"You should now be able to type:","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"zJ1kREweMG"}],"key":"ADdQOwImvz"},{"type":"code","lang":"bash","value":"$ make output/report.pdf","position":{"start":{"line":105,"column":1},"end":{"line":107,"column":1}},"key":"dk6Y1k41C1"},{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"If everything worked correctly, the two figures will be created and pdf report\nwill be built.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"vD8hCOwy0d"}],"key":"KsrMxLJnXD"},{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"Let’s go through the Makefile in a bit more detail. We have three rules, two\nfor the figures and one for the report. Let’s look at the rule for\n","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"mKfMLXuKKz"},{"type":"inlineCode","value":"output/figure_1.png","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"argGgpnfMP"},{"type":"text","value":" first. This rule has the target\n","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"CRfONc4fxo"},{"type":"inlineCode","value":"output/figure_1.png","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"hTlKMztuQB"},{"type":"text","value":" that has two prerequisites: ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"cTnG43L7KT"},{"type":"inlineCode","value":"data/input_file_1.csv","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"goZJXyhR0r"},{"type":"text","value":"\nand ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"Dnv0V1j1be"},{"type":"inlineCode","value":"scripts/generate_histogram.py","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"TIouqhLWAf"},{"type":"text","value":". By giving the output file these\nprerequisites it will be updated if either of these files changes. This is one\nof the reasons why Make was created: to update output files when source files\nchange.","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"haaX5nckV4"}],"key":"z9jKe2fjsR"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"You’ll notice that the recipe line calls Python with the script name and uses\ncommand line flags (","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"E2F3P8posD"},{"type":"inlineCode","value":"-i","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"hexrsSqbOM"},{"type":"text","value":" and ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"SMib3KHdZy"},{"type":"inlineCode","value":"-o","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"XPj6IirbTF"},{"type":"text","value":") to mark the input and output of the\nscript. This isn’t a requirement for using Make, but it makes it easy to see\nwhich file is an input to the script and which is an output.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"R0xIoE6vwr"}],"key":"AHw9ROdKo4"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"The rule for the PDF report is very similar, but it has three prerequisites\n(the LaTeX source and both figures). Notice that the recipe changes the\nworking directory before calling LaTeX and also moves the generated PDF to the\noutput directory. We’re doing this to keep the LaTeX intermediate files in the\nreport directory. However, it’s important to distinguish the above rule from\nthe following:","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"Imcu2GlDN7"}],"key":"jntUEv5Zbe"},{"type":"code","lang":"makefile","value":"# don't do this\noutput/report.pdf: report/report.tex output/figure_1.png output/figure_2.png\n\tcd report/\n\tpdflatex report.tex\n\tmv report.pdf ../output/report.pdf","position":{"start":{"line":133,"column":1},"end":{"line":139,"column":1}},"key":"AIi93CXWhy"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"This rule places the three commands on separate lines. However, ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"sLngtqsLOk"},{"type":"strong","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"Make\nexecutes each line independently","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"ITyFbXEbZO"}],"key":"ICxgsajfO8"},{"type":"text","value":" in a separate subshell, so changing the\nworking directory in the first line has no effect on the second, and a failure\nin the second line won’t stop the third line from being executed. Therefore,\nwe combine the three commands in a single recipe above.","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"Rs5Sa3Atpa"}],"key":"FbCcfCungv"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"This is what the dependency tree looks like for this Makefile:","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"IORZ77owGj"}],"key":"seAziYy3Eh"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"image","url":"/build/makefile-no1-b529243d7ed81a06ff2fc30b6b03054d.png","alt":"DAG for Makefile no. 1","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"W1DNmzxJ5r","urlSource":"../../../figures/makefile-no1.png"},{"type":"text","value":"\n","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"h6Pmlqca9r"},{"type":"paragraph","children":[{"type":"text","value":"The dependency graph for our first Makefile, created using ","key":"nYEIbqZadv"},{"type":"link","url":"https://github.com/lindenb/makefile2graph","children":[{"type":"text","value":"makefile2graph","key":"vYWmTUM2ZV"}],"urlSource":"https://github.com/lindenb/makefile2graph","error":true,"key":"neQKprO2mL"},{"type":"text","value":" . Notice the similarity to the figure","key":"NMLQ9wiSvJ"}],"key":"JA0O7gPjMW"},{"type":"span","class":"reference role unhandled","children":[{"type":"inlineCode","value":"{ref}","key":"q8VuagOfT7"},{"type":"inlineCode","value":"rr-make-summary","key":"mRg1KwqCjC"}],"key":"VBFYF8P9fk"},{"type":"paragraph","children":[{"type":"text","value":"!","key":"RcnKsXcXnT"}],"key":"oF4Mu5AqcM"}],"key":"RmROe5MuyS"},{"type":"heading","depth":3,"position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"children":[{"type":"text","value":"Makefile no. 2 (all and clean)","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"W0GgDdMHD0"}],"label":"rr-make-examples-makefile2","identifier":"rr-make-examples-makefile2","html_id":"rr-make-examples-makefile2","key":"CLFPbyvNEe"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"In our first Makefile we have the basic rules in place. We could stick with\nthis if we wanted to, but there are a few improvements we can make:","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"bEW01rUgBz"}],"key":"frd0bDSZfW"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":161,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":161,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"We now have to explicitly call ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"GbNIho4oz3"},{"type":"inlineCode","value":"make output/report.pdf","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"aaCcyzt8yf"},{"type":"text","value":" if we want to\nmake the report.","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"wuShs5A7JR"}],"key":"aBFaWaYqvZ"}],"key":"BPlYrwst0v"},{"type":"listItem","spread":true,"position":{"start":{"line":164,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"text","value":"We have no way to clean up and start fresh.","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"TarBgVoJKU"}],"key":"H0Un7BDOxt"}],"key":"BiltaXX5Rv"}],"key":"De8NITNsPc"},{"type":"paragraph","position":{"start":{"line":166,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"Let’s remedy this by adding two new targets: ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"qmwKpipowY"},{"type":"inlineCode","value":"all","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"yP3BcXamgW"},{"type":"text","value":" and ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"fBSDc3xs4Y"},{"type":"inlineCode","value":"clean","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"cwEZXHFJYb"},{"type":"text","value":". In your\neditor, change the Makefile contents to add the ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"PSyBCd6TZ5"},{"type":"inlineCode","value":"all","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"Suf8mls3YM"},{"type":"text","value":" and ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"t84Ui9BXRi"},{"type":"inlineCode","value":"clean","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"v8MjgduXlf"},{"type":"text","value":" rules as\nfollows:","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"GsZjwjg89q"}],"key":"LzqLR5SS75"},{"type":"code","lang":"makefile","value":"# Makefile for analysis report\n\nall: output/report.pdf\n\noutput/figure_1.png: data/input_file_1.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i data/input_file_1.csv -o output/figure_1.png\n\noutput/figure_2.png: data/input_file_2.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i data/input_file_2.csv -o output/figure_2.png\n\noutput/report.pdf: report/report.tex output/figure_1.png output/figure_2.png\n\tcd report/ && pdflatex report.tex && mv report.pdf ../output/report.pdf\n\nclean:\n\trm -f output/report.pdf\n\trm -f output/figure_*.png","position":{"start":{"line":170,"column":1},"end":{"line":187,"column":1}},"key":"XepceMd2a6"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"Note that we’ve added the ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"NHxXh2tBE9"},{"type":"inlineCode","value":"all","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"LOH0gKh6L6"},{"type":"text","value":" target to the top of the file. We do this\nbecause Make executes the ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"doDefIfD0z"},{"type":"emphasis","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"first","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"ErbTBgzedk"}],"key":"ADyd7vv1yY"},{"type":"text","value":" target when no explicit target is given.  So\nyou can now type ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"aYy5gSBjI3"},{"type":"inlineCode","value":"make","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"PYg2aaCNJN"},{"type":"text","value":" on the command line and it would do the same as\n","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"COJN1Uwkfs"},{"type":"inlineCode","value":"make all","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"p36cteq46O"},{"type":"text","value":".  Also, note that we’ve only added the report as the prerequisite\nof ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"UMPKaQuNvo"},{"type":"inlineCode","value":"all","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"EjzjaULtWw"},{"type":"text","value":" because that’s our desired output and the other rules help to build\nthat output. If you have multiple outputs, you could add these as further\nprerequisites to the ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"VShvUNMzxF"},{"type":"inlineCode","value":"all","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"XZghEroDjN"},{"type":"text","value":" target. Calling the main target ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"FkEL3PK3w3"},{"type":"inlineCode","value":"all","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"mpWkAdqadI"},{"type":"text","value":" is a\nconvention of Makefiles that many people follow.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"h1PyWJfCYQ"}],"key":"HGqF75xbZp"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"UD5oMhJ1YT"},{"type":"inlineCode","value":"clean","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"aBXEMdaKL1"},{"type":"text","value":" rule is typically at the bottom, but that’s more style than\nrequirement. Note that we use the ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"CY0bBHG86H"},{"type":"inlineCode","value":"-f","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"E4FCtu9NEz"},{"type":"text","value":" flag to ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"qR0zl1vQR5"},{"type":"inlineCode","value":"rm","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"uPUyQzvK1e"},{"type":"text","value":" to make sure it\ndoesn’t complain when there is no file to remove.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"zTDsPkYPqL"}],"key":"ce4Sq63HmM"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"You can try out the new Makefile by running:","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"UEXp2W8T0C"}],"key":"JYh87sVpTO"},{"type":"code","lang":"bash","value":"$ make clean\n$ make","position":{"start":{"line":204,"column":1},"end":{"line":207,"column":1}},"key":"uT1P78wiMt"},{"type":"paragraph","position":{"start":{"line":209,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Make should remove the output and intermediate files after the first command,\nand generate them again after the second.","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"R8VhNPi059"}],"key":"on72E2DCCu"},{"type":"heading","depth":3,"position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"Makefile no. 3 (Phony Targets)","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"MWxTfzVbWc"}],"label":"rr-make-examples-makefile3","identifier":"rr-make-examples-makefile3","html_id":"rr-make-examples-makefile3","key":"mP45iJVzXo"},{"type":"paragraph","position":{"start":{"line":215,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"Typically, ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"Bt6ut9uBFe"},{"type":"inlineCode","value":"all","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"D8AFSd0GRW"},{"type":"text","value":" and ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"IQTa5Wths7"},{"type":"inlineCode","value":"clean","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"MS0aMOs5nl"},{"type":"text","value":" are defined as so-called ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"fNnEVXomkZ"},{"type":"link","url":"https://www.gnu.org/software/make/manual/make.html#Phony-Targets","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"text","value":"Phony\nTargets","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"lCWQ1TdCZj"}],"urlSource":"https://www.gnu.org/software/make/manual/make.html#Phony-Targets","key":"O2yUU2XyO8"},{"type":"text","value":".\nThese are targets that don’t actually create an output file. If not marked as ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"oeoWvhFvCW"},{"type":"inlineCode","value":".PHONY","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"FTWuS1EP2F"},{"type":"text","value":" these targets would\nalways be run if they come up in a dependency, but will no longer be run if a\ndirectory/file is ever created that is called ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"lZ4I5LXIXc"},{"type":"inlineCode","value":"all","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"S0HMHY0tGl"},{"type":"text","value":" or ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"Outl0JdZ70"},{"type":"inlineCode","value":"clean","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"lMc3y50A8W"},{"type":"text","value":". We\ntherefore add a line at the top of the Makefile to define these two as phony\ntargets:","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"DSMDadcvoJ"}],"key":"ANQBmDThIW"},{"type":"code","lang":"makefile","value":"# Makefile for analysis report\n\n.PHONY: all clean\n\nall: output/report.pdf\n\noutput/figure_1.png: data/input_file_1.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i data/input_file_1.csv -o output/figure_1.png\n\noutput/figure_2.png: data/input_file_2.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i data/input_file_2.csv -o output/figure_2.png\n\noutput/report.pdf: report/report.tex output/figure_1.png output/figure_2.png\n\tcd report/ && pdflatex report.tex && mv report.pdf ../output/report.pdf\n\nclean:\n\trm -f output/report.pdf\n\trm -f output/figure_*.png","position":{"start":{"line":223,"column":1},"end":{"line":242,"column":1}},"key":"oHTNbCJeJa"},{"type":"paragraph","position":{"start":{"line":244,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"Phony targets are also useful when you want to use Make recursively. In that\ncase you would specify the subdirectories as phony targets. You can read more\nabout ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"FaX2J6plza"},{"type":"link","url":"https://www.gnu.org/software/make/manual/make.html#Phony-Targets","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"phony targets in the\ndocumentation","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"cm9P6ABmGi"}],"urlSource":"https://www.gnu.org/software/make/manual/make.html#Phony-Targets","key":"waufYxk2G1"},{"type":"text","value":",\nbut for now it’s enough to know that ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"mfABVSnBD1"},{"type":"inlineCode","value":"all","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"KRpicXhbdK"},{"type":"text","value":" and ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"oz79M6V5eU"},{"type":"inlineCode","value":"clean","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"oX7HAqSF4r"},{"type":"text","value":" are typically\ndeclared as phony.","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"x16yB1pd2n"}],"key":"gn9iqhXNaK"},{"type":"blockquote","position":{"start":{"line":251,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"Sidenote: another target that’s typically phony is ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"l6yrniZGNd"},{"type":"strong","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"test","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"Gqx9wgwYOS"}],"key":"O3a0wHuH8I"},{"type":"text","value":", in case you\nhave a directory of tests called ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"O14OT6jJ32"},{"type":"strong","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"test","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"PRqR7xr4Zh"}],"key":"WcJHGU7tR0"},{"type":"text","value":" and want to have a target to run\nthem that’s also called ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"DSbGuw1gL5"},{"type":"strong","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"test","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"LCWujoxWL7"}],"key":"QEFU1ooc6g"},{"type":"text","value":".","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"AKT4ulKBwi"}],"key":"vmujxcLMlE"}],"key":"JUQFjkFwYj"},{"type":"heading","depth":3,"position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"Makefile no. 4 (Automatic Variables and Pattern Rules)","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"oDUH86Lsgk"}],"label":"rr-make-examples-makefile4","identifier":"rr-make-examples-makefile4","html_id":"rr-make-examples-makefile4","key":"QuvcyBhAY9"},{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"There’s nothing wrong with the Makefile we have now, but it’s somewhat verbose\nbecause we’ve declared all the targets explicitly using separate rules. We can\nsimplify this by using ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"Wut3U1wSjK"},{"type":"link","url":"https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"Automatic\nVariables","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"fcWtN1AEr9"}],"urlSource":"https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html","key":"FCoVh6dtI4"},{"type":"text","value":"\nand ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"GtnLgSzgDs"},{"type":"link","url":"https://www.gnu.org/software/make/manual/html_node/Pattern-Rules.html#Pattern-Rules","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"Pattern\nRules","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"E6OQfA0lYi"}],"urlSource":"https://www.gnu.org/software/make/manual/html_node/Pattern-Rules.html#Pattern-Rules","key":"oPAsbyqdRz"},{"type":"text","value":".","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"S6kVFBsUjU"}],"key":"nMAVeaYuWt"},{"type":"heading","depth":4,"position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"Automatic Variables.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"x3O6nlSQFC"}],"label":"rr-make-examples-automaticvar","identifier":"rr-make-examples-automaticvar","html_id":"rr-make-examples-automaticvar","key":"czLYp0B4R8"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"With automatic variables we can use the names of the\nprerequisites and targets in the recipe. Here’s how we would do that for the\nfigure rules:","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"tsa7IhIxxJ"}],"key":"DptMqQ58jH"},{"type":"code","lang":"makefile","value":"# Makefile for analysis report\n\n.PHONY: all clean\n\nall: output/report.pdf\n\noutput/figure_1.png: data/input_file_1.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i $< -o $@\n\noutput/figure_2.png: data/input_file_2.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i $< -o $@\n\noutput/report.pdf: report/report.tex output/figure_1.png output/figure_2.png\n\tcd report/ && pdflatex report.tex && mv report.pdf ../output/report.pdf\n\nclean:\n\trm -f output/report.pdf\n\trm -f output/figure_*.png","position":{"start":{"line":272,"column":1},"end":{"line":291,"column":1}},"key":"tsYOUTS9N1"},{"type":"paragraph","position":{"start":{"line":293,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"We’ve replaced the input and output filenames in the recipes respectively by\n","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"SmtibKAkgp"},{"type":"inlineCode","value":"$<","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"PXhN69Hvoi"},{"type":"text","value":", which denotes the ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"vNweSryFkW"},{"type":"emphasis","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"first","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"KbGuMoye9j"}],"key":"bCNSfwv8kE"},{"type":"text","value":" prerequisite and ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"bgcvgjOJaX"},{"type":"inlineCode","value":"$@","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"MbnWmmNQwf"},{"type":"text","value":" which denotes the\n","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"tcR7yZjQGm"},{"type":"emphasis","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"target","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"SczJlbIa9S"}],"key":"CjpGv22RjD"},{"type":"text","value":". You can remember ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"igkphoGw6B"},{"type":"inlineCode","value":"$<","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"En7xqanCZp"},{"type":"text","value":" because it’s like an arrow that points to\nthe beginning (","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"QKSkiVbX5v"},{"type":"emphasis","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"first","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"zD2ZVhOzbx"}],"key":"Rzg773VOmp"},{"type":"text","value":" prerequisite), and you can remember ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"eLhzjTSqSD"},{"type":"inlineCode","value":"$@","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"ICXuDhFZzc"},{"type":"text","value":" (dollar\n","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"MHjk61VKYD"},{"type":"emphasis","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"at","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"paMbKoqskn"}],"key":"Xi94R3KvfC"},{"type":"text","value":") ","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"DmZHmRXE8u"},{"type":"link","url":"https://jameshfisher.com/2016/12/07/makefile-automatic-variables/","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"as the target you’re aiming\n","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"EuyUFHWRLz"},{"type":"emphasis","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"at","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"pSNGonGwrM"}],"key":"JOHZPdUL8n"}],"urlSource":"https://jameshfisher.com/2016/12/07/makefile-automatic-variables/","key":"NvMI9nNInP"},{"type":"text","value":".","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"OZWSwi9NDS"}],"key":"zggQa3vxbG"},{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"text","value":"There are more automatic variables that you could use, see ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"nSLP135E7V"},{"type":"link","url":"https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"the\ndocumentation","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"dqFMt9wMNW"}],"urlSource":"https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html","key":"UwmV57SrLw"},{"type":"text","value":".","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"DmxpidOADK"}],"key":"x69MnQxT47"},{"type":"heading","depth":4,"position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"Pattern Rules","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"ktNo7Lww5N"}],"label":"rr-make-examples-patternrules","identifier":"rr-make-examples-patternrules","html_id":"rr-make-examples-patternrules","key":"y9CrKAAGbr"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"Notice that the recipes for the figures have become\nidentical!  Because we don’t like to repeat ourselves, we can combine the two\nrules into a single rule by using ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"fuQ4RJK0PE"},{"type":"emphasis","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"pattern rules","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"IQXJQdVCIz"}],"key":"B1j6IwCmKX"},{"type":"text","value":". Pattern rules allow you to\nuse the ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"HWbTjI8NCE"},{"type":"inlineCode","value":"%","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"Ij9zGUzPlx"},{"type":"text","value":" symbol as a wildcard and combine the two rules into one:","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"Fj1Y55fj8o"}],"key":"n3JtE6k96I"},{"type":"code","lang":"makefile","value":"# Makefile for analysis report\n\n.PHONY: all clean\n\nall: output/report.pdf\n\noutput/figure_%.png: data/input_file_%.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i $< -o $@\n\noutput/report.pdf: report/report.tex output/figure_1.png output/figure_2.png\n\tcd report/ && pdflatex report.tex && mv report.pdf ../output/report.pdf\n\nclean:\n\trm -f output/report.pdf\n\trm -f output/figure_*.png","position":{"start":{"line":311,"column":1},"end":{"line":327,"column":1}},"key":"Cuz0daitIw"},{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"gFXwYmmkqt"},{"type":"inlineCode","value":"%","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"CEeRcZ4hWX"},{"type":"text","value":" symbol is now a wildcard that (in our case) takes the value ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"vQWnViyHkD"},{"type":"inlineCode","value":"1","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"XmuJ1TvnNf"},{"type":"text","value":" or\n","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"T4TVcwd8hC"},{"type":"inlineCode","value":"2","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"eVVxdZWEbz"},{"type":"text","value":" based on the input files in the ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"adue9S7jpe"},{"type":"inlineCode","value":"data","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"HkXUjOyqqh"},{"type":"text","value":" directory. You can check that\neverything still works by running ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"ImFOEcLHbU"},{"type":"inlineCode","value":"make clean","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"E861QRQQnL"},{"type":"text","value":" followed by ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"nE68IP3yWO"},{"type":"inlineCode","value":"make","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"vggSKGItnS"},{"type":"text","value":".","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"Rxhf0fvK7O"}],"key":"ga8HhyOoPh"},{"type":"paragraph","position":{"start":{"line":333,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"An advantage of this is that if you now want to add another dataset, say\n","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"u6yXTj2Mvq"},{"type":"inlineCode","value":"input_file_3","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"I3A1BwTcKS"},{"type":"text","value":", then you would only need to add that to the rule for the\nreport!","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"QWNqyOMIHM"}],"key":"dE5r8EwTA8"},{"type":"heading","depth":3,"position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"Makefile no. 5 (Wildcards and Path Substitution)","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"UUl1J8HmFJ"}],"label":"rr-make-examples-makefile5","identifier":"rr-make-examples-makefile5","html_id":"rr-make-examples-makefile5","key":"VvLMYQyYBO"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"text","value":"When Makefiles get more complex, you may want to use more advanced features\nsuch as building outputs for all the files in an input directory. While\npattern rules will get you a long way, Make also has features for wildcards\nand string or path manipulation for when pattern rules are insufficient.","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"V2MAShCJwd"}],"key":"m6B09xafqd"},{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"text","value":"While previously our input files were numbered, we’ll now switch to a scenario\nwhere they have more meaningful names. Let’s switch over to the ","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"JXOWTSuGIG"},{"type":"inlineCode","value":"big_data","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"ssB0W7VIVZ"},{"type":"text","value":"\nbranch:","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"QsrWzSYkVw"}],"key":"WCj3brt8iE"},{"type":"code","lang":"bash","value":"$ git checkout big_data         # checkout the big_data branch","position":{"start":{"line":349,"column":1},"end":{"line":351,"column":1}},"key":"Kp4z3tcoNX"},{"type":"paragraph","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"children":[{"type":"text","value":"The directory structure now looks like this:","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":1}},"key":"xp1UmNLJAd"}],"key":"UKOeKiuGnI"},{"type":"code","lang":"text","value":"├── data/\n│   ├── action.csv\n│   ├── ...\n│   ├── input_file_1.csv\n│   ├── input_file_2.csv\n│   ├── ...\n│   └── western.csv\n├── LICENSE\n├── output/\n├── README.md\n├── report/\n│   └── report.tex\n└── scripts/\n    └── generate_histogram.py","position":{"start":{"line":355,"column":1},"end":{"line":370,"column":1}},"key":"FxsZRFpzTe"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"As you can see, the ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"Vw84jsW2Wf"},{"type":"strong","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"data","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"sSjd7WHDAS"}],"key":"q6eMYhsB55"},{"type":"text","value":" directory now contains additional input files\nthat are named more meaningfully (the data are IMBD movie ratings by genre).\nAlso, the ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"JmIHdnHpIL"},{"type":"strong","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"report.tex","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"xtd6dOuewy"}],"key":"oWeP6mRMtT"},{"type":"text","value":" file has been updated to work with the expected\nfigures.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"lUfymk999V"}],"key":"Y5RFk5dico"},{"type":"paragraph","position":{"start":{"line":377,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"We’ll adapt our Makefile to create a figure in the output directory called\n","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"vr7sjWR9Zc"},{"type":"inlineCode","value":"histogram_{genre}.png","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"DFYRcdcdof"},{"type":"text","value":" for each ","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"lfyTvhVFws"},{"type":"inlineCode","value":"{genre}.csv","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"Uhyr9fwLsn"},{"type":"text","value":" file, while excluding the\n","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"Hci4p3QbOR"},{"type":"inlineCode","value":"input_file_{N}.csv","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"fVHiFVcuh3"},{"type":"text","value":" files.","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"JCPa0BIqAc"}],"key":"vKE97GsVPl"},{"type":"blockquote","position":{"start":{"line":381,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":381,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"Sidenote: if we were to remove the ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"YZEWfbXoew"},{"type":"inlineCode","value":"input_file_{N}.csv","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"n9O65Wqa1Q"},{"type":"text","value":" files, pattern\nrules would be sufficient here. This highlights that sometimes your\ndirectory structure and Makefile should be developed hand in hand.","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"Au9IXdmuqC"}],"key":"QcAhZvB3Gs"}],"key":"CX7iWpxklA"},{"type":"paragraph","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"children":[{"type":"text","value":"Before changing the Makefile, run","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"UtnJKLi8fE"}],"key":"maxsC2qoft"},{"type":"code","lang":"bash","value":"$ make clean","position":{"start":{"line":387,"column":1},"end":{"line":389,"column":1}},"key":"qW6nAHJ5pW"},{"type":"paragraph","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"to remove the output files.","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"mHa2jTkDwj"}],"key":"NBgYJLOji5"},{"type":"paragraph","position":{"start":{"line":392,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"We’ll show the full Makefile first, and then describe the different lines in\nmore detail. The complete file is:","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"KjaCQY4pqP"}],"key":"isxrNc1Air"},{"type":"code","lang":"makefile","value":"# Makefile for analysis report\n#\n\nALL_CSV = $(wildcard data/*.csv)\nINPUT_CSV = $(wildcard data/input_file_*.csv)\nDATA = $(filter-out $(INPUT_CSV),$(ALL_CSV))\nFIGURES = $(patsubst data/%.csv,output/figure_%.png,$(DATA))\n\n.PHONY: all clean\n\nall: output/report.pdf\n\n$(FIGURES): output/figure_%.png: data/%.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i $< -o $@\n\noutput/report.pdf: report/report.tex $(FIGURES)\n\tcd report/ && pdflatex report.tex && mv report.pdf ../$@\n\nclean:\n\trm -f output/report.pdf\n\trm -f $(FIGURES)","position":{"start":{"line":395,"column":1},"end":{"line":417,"column":1}},"key":"fwuJmIJwp0"},{"type":"paragraph","position":{"start":{"line":419,"column":1},"end":{"line":421,"column":1}},"children":[{"type":"text","value":"First, we use the ","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"oz8hMcosWc"},{"type":"inlineCode","value":"wildcard","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"GzN0Jf8slI"},{"type":"text","value":" function to create a variable that lists all\nthe CSV files in the data directory and one that lists only the old\n","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"rkKjqvvJVm"},{"type":"inlineCode","value":"input_file_{N}.csv","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"iaWX2DN2SH"},{"type":"text","value":" files:","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"RKwconxkZF"}],"key":"ymyFtr1HFq"},{"type":"code","lang":"makefile","value":"ALL_CSV = $(wildcard data/*.csv)\nINPUT_CSV = $(wildcard data/input_file_*.csv)","position":{"start":{"line":423,"column":1},"end":{"line":426,"column":1}},"key":"OgGGkGVDNf"},{"type":"paragraph","position":{"start":{"line":428,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"A code convention for Makefiles is to use all capitals for variable names and\ndefine them at the top of the file.","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"key":"PyCSgmRLtj"}],"key":"VgfCoeu5kq"},{"type":"paragraph","position":{"start":{"line":431,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"Next, we create a variable to list only the data files that we’re interested\nin by filtering out the ","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"xVhvaeD17g"},{"type":"inlineCode","value":"INPUT_CSV","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"qJ36vrCcMH"},{"type":"text","value":" from ","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"aUvMKb9jCC"},{"type":"inlineCode","value":"ALL_CSV","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"rboQoHKD2L"},{"type":"text","value":":","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"GjdN3rXQ27"}],"key":"m0xLsUfGq5"},{"type":"code","lang":"makefile","value":"DATA = $(filter-out $(INPUT_CSV),$(ALL_CSV))","position":{"start":{"line":434,"column":1},"end":{"line":436,"column":1}},"key":"n6M05k9A22"},{"type":"paragraph","position":{"start":{"line":438,"column":1},"end":{"line":443,"column":1}},"children":[{"type":"text","value":"This line uses the\n","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"ltJTQ4WS9u"},{"type":"link","url":"https://www.gnu.org/software/make/manual/make.html#index-filter_002dout","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"children":[{"type":"inlineCode","value":"filter-out","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"xXZY9AGBlf"}],"urlSource":"https://www.gnu.org/software/make/manual/make.html#index-filter_002dout","key":"JL9yPt9NRG"},{"type":"text","value":"\nfunction to remove items in the ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"AeUokB0AZb"},{"type":"inlineCode","value":"INPUT_CSV","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"r0Li1OsR5z"},{"type":"text","value":" variable from the ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"nmvQP8Cevm"},{"type":"inlineCode","value":"ALL_CSV","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"eMK5ic2HQQ"},{"type":"text","value":"\nvariable.  Note that we use both the ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"FTZJl4H6lG"},{"type":"inlineCode","value":"$( ... )","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"iaux25HRYj"},{"type":"text","value":" syntax for functions and\nvariables. Finally, we’ll use the ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"nKZCVGotjG"},{"type":"inlineCode","value":"DATA","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"eLxdxUBoaT"},{"type":"text","value":" variable to create a ","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"yHMUFFUqLa"},{"type":"inlineCode","value":"FIGURES","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"JH0E4x9OUa"},{"type":"text","value":"\nvariable with the desired output:","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"NJ1qIfrCMx"}],"key":"xEdtIy3eqz"},{"type":"code","lang":"makefile","value":"FIGURES = $(patsubst data/%.csv,output/figure_%.png,$(DATA))","position":{"start":{"line":445,"column":1},"end":{"line":447,"column":1}},"key":"fSQTH6KfcL"},{"type":"paragraph","position":{"start":{"line":449,"column":1},"end":{"line":454,"column":1}},"children":[{"type":"text","value":"Here we’ve used the\n","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"XU7ttVGkQQ"},{"type":"link","url":"https://www.gnu.org/software/make/manual/make.html#index-patsubst-1","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"children":[{"type":"inlineCode","value":"patsubst","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"wTS9SUXsQH"}],"urlSource":"https://www.gnu.org/software/make/manual/make.html#index-patsubst-1","key":"ObqydrrDaB"},{"type":"text","value":"\nfunction to transform the input in the ","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"MwXtvKfBwD"},{"type":"inlineCode","value":"DATA","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"Y1H2Uwr7vk"},{"type":"text","value":" variable (that follows the\n","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"hvvDQU4S9o"},{"type":"inlineCode","value":"data/{genre}.csv","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"a3wakKgob4"},{"type":"text","value":" pattern) to the desired output filenames (using the\n","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"PIwmxgvGOd"},{"type":"inlineCode","value":"output/figure_{genre}.png","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"aR1ZAGjf36"},{"type":"text","value":" pattern). Notice that the ","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"jtRnwrMuPB"},{"type":"inlineCode","value":"%","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"aCvsydSJw9"},{"type":"text","value":" character marks\nthe part of the filename that will be the same in both the input and output.","position":{"start":{"line":449,"column":1},"end":{"line":449,"column":1}},"key":"HpSWct6rWt"}],"key":"vqcRvVbtEs"},{"type":"paragraph","position":{"start":{"line":456,"column":1},"end":{"line":456,"column":1}},"children":[{"type":"text","value":"Now we use these variables for the figure generation rule as follows:","position":{"start":{"line":456,"column":1},"end":{"line":456,"column":1}},"key":"e3HplOWDOh"}],"key":"jSF1cp4952"},{"type":"code","lang":"makefile","value":"$(FIGURES): output/figure_%.png: data/%.csv scripts/generate_histogram.py\n\tpython scripts/generate_histogram.py -i $< -o $@","position":{"start":{"line":458,"column":1},"end":{"line":461,"column":1}},"key":"A8878CGyfO"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":468,"column":1}},"children":[{"type":"text","value":"This rule again applies a pattern: it takes a list of targets (","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"jyJE7RSQBR"},{"type":"inlineCode","value":"$(FIGURES)","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"MLOizNWyl5"},{"type":"text","value":")\nthat all follow a given pattern (","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"YjIReAtTQh"},{"type":"inlineCode","value":"output/figure_%.png","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"PHogunmY9C"},{"type":"text","value":") and based on that\ncreates a prerequisite (","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"y4kvwUzCyO"},{"type":"inlineCode","value":"data/%.csv","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"fyzuZQsPls"},{"type":"text","value":"). Such a pattern rule is slightly\ndifferent from the one we saw before because it uses two ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"GOtq0MmWoF"},{"type":"inlineCode","value":":","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"WquiP2LIsE"},{"type":"text","value":" symbols. It is\ncalled a ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"sk1YSI3bii"},{"type":"link","url":"https://www.gnu.org/software/make/manual/make.html#Static-Pattern","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"static pattern\nrule","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"EiIeI5g4T2"}],"urlSource":"https://www.gnu.org/software/make/manual/make.html#Static-Pattern","key":"z2CNZTj6Pu"},{"type":"text","value":".","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"vWkomXSleL"}],"key":"ecix3pzu4I"},{"type":"paragraph","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"children":[{"type":"text","value":"Of course we have to update the ","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"aeKlRcSMBv"},{"type":"inlineCode","value":"report.pdf","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"ULUOBPXQJx"},{"type":"text","value":" rule as well:","position":{"start":{"line":470,"column":1},"end":{"line":470,"column":1}},"key":"kfQZWuNbhp"}],"key":"qHRlYvL8uc"},{"type":"code","lang":"makefile","value":"output/report.pdf: report/report.tex $(FIGURES)\n\tcd report/ && pdflatex report.tex && mv report.pdf ../$@","position":{"start":{"line":472,"column":1},"end":{"line":475,"column":1}},"key":"XS7b7wcPRs"},{"type":"paragraph","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"children":[{"type":"text","value":"and the ","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"zpdoeWkwGf"},{"type":"inlineCode","value":"clean","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"YLAueUI3Of"},{"type":"text","value":" rule:","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"WELHX2DqYY"}],"key":"jYbMrHgy8J"},{"type":"code","lang":"makefile","value":"clean:\n\trm -f output/report.pdf\n\trm -f $(FIGURES)","position":{"start":{"line":479,"column":1},"end":{"line":483,"column":1}},"key":"L0tJvJVpdU"},{"type":"paragraph","position":{"start":{"line":485,"column":1},"end":{"line":486,"column":1}},"children":[{"type":"text","value":"If you run this Makefile, it will need to build 28 figures. You may want to\nuse the ","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"lwU1j5mzsD"},{"type":"inlineCode","value":"-j","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"P1B76PoRzB"},{"type":"text","value":" flag to ","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"ZXsAWXSVBe"},{"type":"inlineCode","value":"make","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"TeTIXTT1kY"},{"type":"text","value":" to build these targets ","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"O3WMWWscSA"},{"type":"strong","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"children":[{"type":"text","value":"in parallel!","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"mbrBZLCryx"}],"key":"wPjvwwdTRV"}],"key":"H5hKd2QsYX"},{"type":"code","lang":"bash","value":"$ make -j 4","position":{"start":{"line":488,"column":1},"end":{"line":490,"column":1}},"key":"fpEkNEagpW"},{"type":"paragraph","position":{"start":{"line":492,"column":1},"end":{"line":493,"column":1}},"children":[{"type":"text","value":"The ability to build targets in parallel is quite useful when your project has\nmany dependencies!","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"YC1hT9zTiN"}],"key":"S2GIjb9D3E"},{"type":"paragraph","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"children":[{"type":"text","value":"The resulting PDF file should now look like this:","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"t8im9IoO91"}],"key":"uIGYxMrLkN"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"image","url":"/build/make-report-all-genr-3cf449b5eec44b0a9dd3bde280ed3068.png","alt":"Report with all genres","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"iFG41uLaTH","urlSource":"../../../figures/make-report-all-genres.png"},{"type":"text","value":"A compressed view of the report with histograms for all genres.","key":"iocwGfVMsG"}],"key":"mnzVWbD2Jg"}],"key":"VNXnxHnPay"}],"key":"RjRVDVsi0Y"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Reproducibility with Make","url":"/reproducible-research/make","group":"The Turing Way"},"next":{"title":"Debugging Makefiles","url":"/reproducible-research/make/make-debugging","group":"The Turing Way"}}},"domain":"http://localhost:3000"}